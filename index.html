<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Belajar WebGL</title>

    <script type="text/javascript" src="data.js"></script>
    <script type="text/javascript" src="main.js"></script>

    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #f0f0f0, #d0d0d0);
            font-family: Arial, sans-serif;
        }
        canvas {
            border: 2px solid #333;
            background: white;
        }
        #textureInput {
            position: absolute;
            top: 20px;
            left: 20px;
            background: white;
            padding: 5px;
            border-radius: 5px;
        }
    </style>
</head>
<body onload="main()">

    <canvas id="myCanvas" width="750" height="650"></canvas>
    <input type="file" id="textureInput" accept="image/*">

    <!-- === Vertex Shader === -->
    <script id="vertexShaderCode" type="notjs">
        attribute vec3 aPosition;
        attribute vec3 aColor;
        attribute vec3 aNormal;
        attribute vec2 aTexCoord;

        varying vec3 vColor;
        varying vec3 vNormal;
        varying vec3 vPosition;
        varying vec2 vTexCoord;

        uniform mat4 uFormMatrix;

        void main(){
            vColor = aColor;
            vNormal = aNormal;
            vPosition = aPosition;
            vTexCoord = aTexCoord;
            gl_Position = uFormMatrix * vec4(aPosition, 1.0);
        }
    </script>

    <!-- === Fragment Shader === -->
    <script id="fragmentShaderCode" type="notjs">
        precision mediump float;

        varying vec3 vColor;
        varying vec3 vNormal;
        varying vec3 vPosition;
        varying vec2 vTexCoord;

        uniform sampler2D uSampler;
        uniform bool uUseTexture;

        void main(){
            vec3 normal = normalize(vNormal);
            vec3 lightDir = normalize(vec3(0.5, 0.8, 1.0));
            vec3 viewDir  = normalize(vec3(0.0, 0.0, 1.0));

            // ambil warna dari tekstur (kalau ada)
            vec3 texColor = texture2D(uSampler, vTexCoord).rgb;
            vec3 baseColor = uUseTexture ? texColor : vColor;

            vec3 ambient = 0.5 * baseColor;
            float diff = max(dot(normal, lightDir), 0.0);
            vec3 diffuse = diff * baseColor;

            vec3 reflectDir = reflect(-lightDir, normal);
            float spec = pow(max(dot(viewDir, reflectDir), 0.0), 32.0);
            vec3 specular = spec * vec3(1.0);

            gl_FragColor = vec4(ambient + diffuse + specular, 1.0);
        }
    </script>

</body>
</html>
